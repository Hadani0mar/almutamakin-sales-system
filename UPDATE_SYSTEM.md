# نظام التحديث التلقائي - Auto Update System

## نظرة عامة

تم إضافة نظام تحديث تلقائي للتطبيق يستخدم GitHub Releases للتحقق من التحديثات وتنزيلها وتثبيتها تلقائياً.

## المكونات

### 1. UpdateService (`lib/services/update_service.dart`)
خدمة رئيسية تتعامل مع:
- التحقق من وجود تحديثات جديدة من GitHub Releases
- تنزيل التحديثات مع تتبع التقدم
- تثبيت التحديثات (استخراج ZIP أو تشغيل EXE)
- إعادة تشغيل التطبيق بعد التثبيت

### 2. UpdateCheckScreen (`lib/screens/update_check_screen.dart`)
واجهة المستخدم للتحقق من التحديثات:
- عرض حالة التحديث
- عرض ملاحظات الإصدار
- تنزيل وتثبيت التحديثات
- شريط تقدم التنزيل

## كيفية الاستخدام

### للمستخدم:
1. افتح التطبيق
2. من القائمة الجانبية، اضغط على "التحقق من التحديثات"
3. إذا كان هناك تحديث متاح، اضغط على "تنزيل وتثبيت"
4. سيتم تنزيل التحديث تلقائياً وتثبيته
5. سيتم إعادة تشغيل التطبيق تلقائياً

### للمطور - إنشاء Release جديد:

#### الطريقة 1: استخدام GitHub CLI
```powershell
# تثبيت GitHub CLI أولاً من: https://cli.github.com/
gh release create v1.0.1 Almutamakin_Sales_System_v1.0.1.zip --title "الإصدار 1.0.1" --notes "ملاحظات الإصدار" --repo Hadani0mar/almutamakin-sales-system
```

#### الطريقة 2: يدوياً من GitHub
1. اذهب إلى: https://github.com/Hadani0mar/almutamakin-sales-system/releases/new
2. أدخل رقم الإصدار (مثل: v1.0.1)
3. أضف عنوان وملاحظات الإصدار
4. ارفع ملف ZIP أو EXE
5. اضغط "Publish release"

#### الطريقة 3: استخدام السكريبت
```powershell
.\scripts\create_release.ps1 -Version "1.0.1" -ZipPath "C:\path\to\file.zip" -ReleaseNotes "ملاحظات الإصدار"
```

## هيكل ملف التحديث

عند إنشاء ملف ZIP للتحديث، يجب أن يحتوي على:
- `kids_app.exe` - الملف التنفيذي الرئيسي
- `flutter_windows.dll` - مكتبة Flutter
- `data/` - مجلد البيانات والأصول
- جميع الملفات المطلوبة للتشغيل

## الإعدادات

في `lib/services/update_service.dart`:
- `githubOwner`: مالك المستودع (Hadani0mar)
- `githubRepo`: اسم المستودع (almutamakin-sales-system)

## ملاحظات مهمة

1. **النسخ الاحتياطي**: يتم إنشاء نسخة احتياطية تلقائياً قبل التثبيت
2. **إعادة التشغيل**: التطبيق يعيد تشغيل نفسه تلقائياً بعد التثبيت
3. **الأمان**: تأكد من أن ملفات التحديث من مصدر موثوق
4. **الإصدارات**: استخدم تنسيق semver (مثل: 1.0.0, 1.0.1, 1.1.0)

## استكشاف الأخطاء

- إذا فشل التنزيل: تحقق من الاتصال بالإنترنت
- إذا فشل التثبيت: تحقق من صلاحيات الكتابة في مجلد التطبيق
- إذا لم يظهر تحديث: تأكد من أن رقم الإصدار في pubspec.yaml أقل من الإصدار على GitHub

